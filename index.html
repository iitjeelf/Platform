# Run this cell to launch the interface with PDF generation
class ColabPDFResultsInterface:
    def __init__(self):
        self.base_path = '/content/drive/MyDrive'
        self.current_path = self.base_path
        self.uploaded_files = {}
        self.current_data = None
        self.analysis_results = []
        self.setup_interface()
        
    def setup_interface(self):
        """Setup the complete results interface with PDF support"""
        # CSS Styling
        style = """
        <style>
        .widget-label { font-weight: bold; color: #1a73e8; }
        .success { color: #0f9d58; font-weight: bold; }
        .error { color: #db4437; font-weight: bold; }
        .warning { color: #f4b400; font-weight: bold; }
        .info { color: #1a73e8; font-weight: bold; }
        .result-box { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 8px; 
            border-left: 4px solid #1a73e8;
            margin: 10px 0;
        }
        </style>
        """
        display(HTML(style))
        
        # HEADER
        self.header = widgets.HTML(
            value="""
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                       padding: 20px; border-radius: 10px; color: white; text-align: center; margin-bottom: 20px;">
                <h1 style="margin: 0;">üìä Colab Results Interface with PDF Export</h1>
                <p style="margin: 5px 0 0 0; opacity: 0.9;">Upload ‚Üí Analyze ‚Üí Generate PDF Reports</p>
            </div>
            """
        )
        
        # TAB INTERFACE
        self.tab = widgets.Tab()
        
        # TAB 1: FILE UPLOADER
        self.setup_file_upload_tab()
        
        # TAB 2: DATA ANALYSIS
        self.setup_analysis_tab()
        
        # TAB 3: VISUALIZATION
        self.setup_visualization_tab()
        
        # TAB 4: PDF REPORT GENERATOR
        self.setup_pdf_tab()
        
        self.tab.children = [
            self.upload_tab,
            self.analysis_tab,
            self.visualization_tab,
            self.pdf_tab
        ]
        
        self.tab.titles = ['üìÅ Upload Files', 'üìä Analyze Data', 'üìà Visualize', 'üìÑ Generate PDF']
        
        # MAIN OUTPUT AREA
        self.main_output = widgets.Output(layout={'border': '1px solid #ccc', 'padding': '10px', 'min_height': '400px'})
        
        # DISPLAY EVERYTHING
        display(self.header)
        display(self.tab)
        display(self.main_output)
        
        # Initial file refresh
        self.refresh_files()
    
    def setup_file_upload_tab(self):
        """Setup file upload tab"""
        # Navigation
        nav_box = widgets.HBox([
            widgets.Button(description="‚¨ÖÔ∏è Back", layout={'width': '100px'}), 
            widgets.Button(description="üè† Home", layout={'width': '100px'}),
            widgets.Button(description="üîÑ Refresh", layout={'width': '100px'})
        ])
        nav_box.children[0].on_click(self.go_back)
        nav_box.children[1].on_click(self.go_home)
        nav_box.children[2].on_click(self.refresh_files)
        
        self.path_label = widgets.HTML()
        
        # File browser
        self.file_list = widgets.SelectMultiple(
            layout={'width': '100%', 'height': '200px'}
        )
        
        # File actions
        action_box = widgets.HBox([
            widgets.Button(description="üëÅÔ∏è Preview", button_style='warning'),
            widgets.Button(description="üì• Load Data", button_style='info'),
            widgets.Button(description="‚¨ÜÔ∏è Upload to Colab", button_style='success')
        ])
        action_box.children[0].on_click(self.preview_file)
        action_box.children[1].on_click(self.load_data)
        action_box.children[2].on_click(self.upload_files)
        
        self.file_info = widgets.HTML(value="<i>Select files to see information</i>")
        
        self.upload_tab = widgets.VBox([
            widgets.HTML("<h3>üìÅ Upload Files from Google Drive</h3>"),
            nav_box,
            self.path_label,
            self.file_list,
            action_box,
            self.file_info
        ])
    
    def setup_analysis_tab(self):
        """Setup data analysis tab"""
        self.analysis_controls = widgets.VBox([
            widgets.HTML("<h3>üìä Data Analysis Tools</h3>"),
            widgets.HTML("<b>Quick Analysis:</b>"),
            widgets.HBox([
                widgets.Button(description="üìã Basic Info", button_style='info'),
                widgets.Button(description="üìà Describe Data", button_style='info'),
                widgets.Button(description="üîç Find Null Values", button_style='warning')
            ]),
            widgets.HBox([
                widgets.Button(description="üìä Value Counts", button_style='info'),
                widgets.Button(description="üìê Correlation Matrix", button_style='info'),
                widgets.Button(description="üéØ Custom Analysis", button_style='success')
            ]),
            widgets.HTML("<b>Custom Analysis:</b>"),
            widgets.Textarea(
                placeholder="Enter custom pandas code here...\nExample: df.groupby('column')['value'].mean()",
                layout={'width': '100%', 'height': '100px'}
            ),
            widgets.Button(description="üíæ Save to Report", button_style='warning')
        ])
        
        # Connect buttons
        self.analysis_controls.children[2].children[0].on_click(self.show_basic_info)
        self.analysis_controls.children[2].children[1].on_click(self.show_describe)
        self.analysis_controls.children[2].children[2].on_click(self.show_null_values)
        self.analysis_controls.children[3].children[0].on_click(self.show_value_counts)
        self.analysis_controls.children[3].children[1].on_click(self.show_correlation)
        self.analysis_controls.children[3].children[2].on_click(self.run_custom_analysis)
        self.analysis_controls.children[5].on_click(self.save_to_report)
        
        self.analysis_tab = self.analysis_controls
    
    def setup_visualization_tab(self):
        """Setup visualization tab"""
        self.viz_controls = widgets.VBox([
            widgets.HTML("<h3>üìà Data Visualization</h3>"),
            widgets.Dropdown(description="Chart Type:", options=[
                ('Bar Plot', 'bar'),
                ('Line Plot', 'line'),
                ('Histogram', 'hist'),
                ('Scatter Plot', 'scatter'),
                ('Box Plot', 'box'),
                ('Heatmap', 'heatmap'),
                ('Pie Chart', 'pie')
            ]),
            widgets.HBox([
                widgets.Dropdown(description="X Axis:", options=[]),
                widgets.Dropdown(description="Y Axis:", options=[])
            ]),
            widgets.HBox([
                widgets.Button(description="üé® Generate Plot", button_style='success'),
                widgets.Button(description="üíæ Save Plot to PDF", button_style='warning')
            ]),
            widgets.HTML("<b>Plot Settings:</b>"),
            widgets.HBox([
                widgets.IntSlider(description="Width:", min=5, max=15, value=10),
                widgets.IntSlider(description="Height:", min=5, max=15, value=6)
            ])
        ])
        
        self.viz_controls.children[3].children[0].on_click(self.generate_plot)
        self.viz_controls.children[3].children[1].on_click(self.save_plot_to_pdf)
        self.visualization_tab = self.viz_controls
    
    def setup_pdf_tab(self):
        """Setup PDF report generation tab"""
        self.pdf_tab = widgets.VBox([
            widgets.HTML("<h3>üìÑ PDF Report Generator</h3>"),
            widgets.HTML("<b>Report Configuration:</b>"),
            widgets.Text(
                value="Data Analysis Report",
                description="Report Title:",
                layout={'width': '400px'}
            ),
            widgets.Textarea(
                value="This report contains the analysis results from the dataset.",
                description="Report Description:",
                layout={'width': '100%', 'height': '80px'}
            ),
            widgets.HTML("<b>Include in PDF:</b>"),
            widgets.HBox([
                widgets.Checkbox(value=True, description="Basic Info"),
                widgets.Checkbox(value=True, description="Statistical Summary"),
                widgets.Checkbox(value=True, description="Null Analysis")
            ]),
            widgets.HBox([
                widgets.Checkbox(value=True, description="Visualizations"),
                widgets.Checkbox(value=True, description="Correlation Matrix"),
                widgets.Checkbox(value=True, description="Custom Analysis")
            ]),
            widgets.HTML("<b>Generate Report:</b>"),
            widgets.HBox([
                widgets.Button(description="üìÑ Generate PDF Report", button_style='success'),
                widgets.Button(description="üîÑ Clear Report Data", button_style='warning')
            ]),
            widgets.HTML("<b>Saved Analysis Results:</b>"),
            widgets.Textarea(
                value="No analysis results saved yet...",
                description="Report Content:",
                layout={'width': '100%', 'height': '150px'},
                disabled=True
            )
        ])
        
        self.pdf_tab.children[7].children[0].on_click(self.generate_pdf_report)
        self.pdf_tab.children[7].children[1].on_click(self.clear_report_data)
    
    # FILE MANAGEMENT METHODS
    def refresh_files(self, b=None):
        """Refresh file list"""
        try:
            items = []
            for item in os.listdir(self.current_path):
                full_path = os.path.join(self.current_path, item)
                if os.path.isdir(full_path):
                    items.append(f"üìÅ {item}/")
                else:
                    items.append(f"üìÑ {item}")
            
            self.file_list.options = items
            self.path_label.value = f"<b>Current folder:</b> <span class='info'>{self.current_path}</span>"
            
        except Exception as e:
            self.show_output(f"‚ùå Error reading directory: {str(e)}", 'error')
    
    def go_back(self, b):
        """Go to parent directory"""
        if self.current_path != self.base_path:
            self.current_path = os.path.dirname(self.current_path)
            self.refresh_files()
    
    def go_home(self, b):
        """Go to Drive root"""
        self.current_path = self.base_path
        self.refresh_files()
    
    def preview_file(self, b):
        """Preview selected file"""
        if not self.file_list.value:
            self.show_output("‚ùå Please select a file first", 'error')
            return
        
        selected = self.file_list.value[0]
        if selected.startswith("üìÅ"):
            # Navigate into folder
            folder_name = selected[2:-1]
            self.current_path = os.path.join(self.current_path, folder_name)
            self.refresh_files()
        else:
            # Preview file
            file_name = selected[2:]
            file_path = os.path.join(self.current_path, file_name)
            self.show_file_preview(file_path)
    
    def show_file_preview(self, file_path):
        """Show file preview in output"""
        with self.main_output:
            clear_output()
            print(f"üìÑ Previewing: {os.path.basename(file_path)}")
            print("=" * 50)
            
            try:
                if file_path.endswith('.csv'):
                    df = pd.read_csv(file_path, nrows=5)
                    print("First 5 rows:")
                    display(df)
                    
                elif file_path.endswith(('.xlsx', '.xls')):
                    df = pd.read_excel(file_path, nrows=5)
                    print("First 5 rows:")
                    display(df)
                    
                elif file_path.endswith('.json'):
                    df = pd.read_json(file_path)
                    print(f"JSON data shape: {df.shape}")
                    display(df.head())
                    
                else:
                    # Try to read as text
                    with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
                        content = f.read(500)
                        print("First 500 characters:")
                        print(content)
                        if len(content) == 500:
                            print("... (truncated)")
                            
            except Exception as e:
                print(f"‚ùå Error previewing file: {str(e)}")
    
    def load_data(self, b):
        """Load data into memory for analysis"""
        if not self.file_list.value:
            self.show_output("‚ùå Please select a file first", 'error')
            return
        
        selected = self.file_list.value[0]
        if selected.startswith("üìÅ"):
            self.show_output("‚ùå Please select a file, not a folder", 'error')
            return
        
        file_name = selected[2:]
        file_path = os.path.join(self.current_path, file_name)
        
        try:
            with self.main_output:
                clear_output()
                print(f"üîÑ Loading: {file_name}")
                
                if file_path.endswith('.csv'):
                    self.current_data = pd.read_csv(file_path)
                elif file_path.endswith(('.xlsx', '.xls')):
                    self.current_data = pd.read_excel(file_path)
                elif file_path.endswith('.json'):
                    self.current_data = pd.read_json(file_path)
                else:
                    self.show_output("‚ùå Unsupported file format", 'error')
                    return
                
                print(f"‚úÖ SUCCESS! Data loaded into memory")
                print(f"üìä Shape: {self.current_data.shape}")
                print(f"üìù Columns: {list(self.current_data.columns)}")
                print("\nFirst 5 rows:")
                display(self.current_data.head())
                
                # Update visualization dropdowns
                self.update_viz_controls()
                
        except Exception as e:
            self.show_output(f"‚ùå Error loading file: {str(e)}", 'error')
    
    def upload_files(self, b):
        """Upload files to Colab workspace"""
        if not self.file_list.value:
            self.show_output("‚ùå Please select files first", 'error')
            return
        
        # Create upload directory
        os.makedirs('/content/uploaded_files', exist_ok=True)
        
        uploaded_count = 0
        for selected in self.file_list.value:
            if selected.startswith("üìÅ"):
                continue  # Skip folders for now
                
            file_name = selected[2:]
            file_path = os.path.join(self.current_path, file_name)
            dest_path = f"/content/uploaded_files/{file_name}"
            
            try:
                shutil.copy2(file_path, dest_path)
                uploaded_count += 1
                self.uploaded_files[file_name] = dest_path
            except Exception as e:
                self.show_output(f"‚ùå Failed to upload {file_name}: {str(e)}", 'error')
        
        if uploaded_count > 0:
            self.show_output(f"‚úÖ Successfully uploaded {uploaded_count} files to Colab!", 'success')
            self.show_output(f"üìÅ Files saved in: /content/uploaded_files/", 'info')
    
    # ANALYSIS METHODS
    def show_basic_info(self, b):
        """Show basic dataframe info"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        with self.main_output:
            clear_output()
            print("üìã BASIC DATASET INFORMATION")
            print("=" * 50)
            print(f"Shape: {self.current_data.shape}")
            print(f"Columns: {len(self.current_data.columns)}")
            print(f"Total cells: {self.current_data.size}")
            print(f"Memory usage: {self.current_data.memory_usage(deep=True).sum() / 1024**2:.2f} MB")
            print("\nüìä COLUMN TYPES:")
            print(self.current_data.dtypes)
            print("\nüîç FIRST 5 ROWS:")
            display(self.current_data.head())
    
    def show_describe(self, b):
        """Show statistical description"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        with self.main_output:
            clear_output()
            print("üìà STATISTICAL SUMMARY")
            print("=" * 50)
            display(self.current_data.describe())
            
            # Show info about non-numeric columns
            non_numeric = self.current_data.select_dtypes(exclude=[np.number])
            if not non_numeric.empty:
                print("\nüìù NON-NUMERIC COLUMNS SUMMARY:")
                for col in non_numeric.columns:
                    print(f"\n{col}:")
                    print(f"  Unique values: {non_numeric[col].nunique()}")
                    print(f"  Most frequent: {non_numeric[col].mode().iloc[0] if not non_numeric[col].empty else 'N/A'}")
    
    def show_null_values(self, b):
        """Show null value analysis"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        with self.main_output:
            clear_output()
            print("üîç NULL VALUE ANALYSIS")
            print("=" * 50)
            
            null_count = self.current_data.isnull().sum()
            null_percent = (null_count / len(self.current_data)) * 100
            
            null_df = pd.DataFrame({
                'Null Count': null_count,
                'Null Percentage': null_percent
            }).sort_values('Null Count', ascending=False)
            
            display(null_df[null_df['Null Count'] > 0])
            
            if null_count.sum() == 0:
                print("‚úÖ No null values found in the dataset!")
    
    def show_value_counts(self, b):
        """Show value counts for categorical columns"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        with self.main_output:
            clear_output()
            print("üìä VALUE COUNTS ANALYSIS")
            print("=" * 50)
            
            categorical_cols = self.current_data.select_dtypes(include=['object']).columns
            
            if len(categorical_cols) == 0:
                print("No categorical columns found.")
                return
            
            for col in categorical_cols[:5]:  # Show first 5 columns
                print(f"\nüéØ Column: {col}")
                print(f"Unique values: {self.current_data[col].nunique()}")
                value_counts = self.current_data[col].value_counts().head(10)
                display(value_counts)
    
    def show_correlation(self, b):
        """Show correlation matrix"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        numeric_data = self.current_data.select_dtypes(include=[np.number])
        
        if numeric_data.empty:
            self.show_output("‚ùå No numeric columns found for correlation analysis.", 'error')
            return
        
        with self.main_output:
            clear_output()
            print("üìê CORRELATION MATRIX")
            print("=" * 50)
            
            corr_matrix = numeric_data.corr()
            display(corr_matrix)
            
            # Plot heatmap
            plt.figure(figsize=(10, 8))
            sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0)
            plt.title('Correlation Heatmap')
            plt.tight_layout()
            plt.show()
    
    def run_custom_analysis(self, b):
        """Run custom pandas analysis"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        custom_code = self.analysis_controls.children[4].value.strip()
        if not custom_code:
            self.show_output("‚ùå Please enter some pandas code to execute.", 'error')
            return
        
        with self.main_output:
            clear_output()
            print("üéØ CUSTOM ANALYSIS RESULT")
            print("=" * 50)
            print(f"Code: {custom_code}")
            print("-" * 30)
            
            try:
                # Replace df with actual dataframe
                df = self.current_data
                result = eval(custom_code)
                display(result)
            except Exception as e:
                print(f"‚ùå Error executing code: {str(e)}")
    
    def save_to_report(self, b):
        """Save current analysis to report data"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        # Capture the current output
        with self.main_output:
            analysis_text = f"Analysis performed at {datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            self.analysis_results.append(analysis_text)
            
            # Update the report content display
            report_content = "\n".join(self.analysis_results)
            self.pdf_tab.children[8].value = report_content
            
            print("‚úÖ Analysis saved to report!")
    
    def update_viz_controls(self):
        """Update visualization controls with current data columns"""
        if self.current_data is not None:
            columns = list(self.current_data.columns)
            self.viz_controls.children[2].children[0].options = columns
            self.viz_controls.children[2].children[1].options = columns
    
    def generate_plot(self, b):
        """Generate visualization"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        chart_type = self.viz_controls.children[1].value
        x_col = self.viz_controls.children[2].children[0].value
        y_col = self.viz_controls.children[2].children[1].value
        
        with self.main_output:
            clear_output()
            print(f"üìà Generating {chart_type} plot...")
            
            try:
                plt.figure(figsize=(10, 6))
                
                if chart_type == 'bar':
                    if y_col:
                        self.current_data.groupby(x_col)[y_col].mean().plot(kind='bar')
                    else:
                        self.current_data[x_col].value_counts().plot(kind='bar')
                    plt.title(f'Bar Plot: {x_col}')
                    
                elif chart_type == 'line':
                    self.current_data.plot(x=x_col, y=y_col, kind='line')
                    plt.title(f'Line Plot: {x_col} vs {y_col}')
                    
                elif chart_type == 'hist':
                    self.current_data[x_col].hist()
                    plt.title(f'Histogram: {x_col}')
                    
                elif chart_type == 'scatter':
                    self.current_data.plot(x=x_col, y=y_col, kind='scatter')
                    plt.title(f'Scatter Plot: {x_col} vs {y_col}')
                    
                elif chart_type == 'box':
                    self.current_data.boxplot(column=y_col, by=x_col)
                    plt.title(f'Box Plot: {y_col} by {x_col}')
                
                elif chart_type == 'pie':
                    if not y_col:
                        value_counts = self.current_data[x_col].value_counts().head(8)
                        plt.pie(value_counts.values, labels=value_counts.index, autopct='%1.1f%%')
                        plt.title(f'Pie Chart: {x_col}')
                
                plt.xticks(rotation=45)
                plt.tight_layout()
                plt.show()
                
            except Exception as e:
                print(f"‚ùå Error generating plot: {str(e)}")
    
    def save_plot_to_pdf(self, b):
        """Save current plot to PDF preparations"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        # Save the current plot
        plt.savefig('/content/current_plot.png', dpi=300, bbox_inches='tight')
        self.analysis_results.append("Visualization saved: current_plot.png")
        
        with self.main_output:
            print("‚úÖ Plot saved for PDF report!")
    
    def generate_pdf_report(self, b):
        """Generate comprehensive PDF report"""
        if self.current_data is None:
            self.show_output("‚ùå No data loaded. Please load a file first.", 'error')
            return
        
        try:
            with self.main_output:
                clear_output()
                print("üìÑ Generating PDF Report...")
                
                # Create PDF
                pdf = FPDF()
                pdf.add_page()
                
                # Title
                pdf.set_font('Arial', 'B', 16)
                title = self.pdf_tab.children[2].value
                pdf.cell(0, 10, title, 0, 1, 'C')
                pdf.ln(5)
                
                # Date
                pdf.set_font('Arial', 'I', 10)
                pdf.cell(0, 10, f"Generated on: {datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S')}", 0, 1, 'C')
                pdf.ln(10)
                
                # Description
                description = self.pdf_tab.children[3].value
                pdf.set_font('Arial', '', 12)
                pdf.multi_cell(0, 8, description)
                pdf.ln(10)
                
                # Dataset Information
                pdf.set_font('Arial', 'B', 14)
                pdf.cell(0, 10, 'Dataset Overview', 0, 1)
                pdf.set_font('Arial', '', 10)
                
                # Basic info
                pdf.cell(0, 8, f"Shape: {self.current_data.shape}", 0, 1)
                pdf.cell(0, 8, f"Columns: {len(self.current_data.columns)}", 0, 1)
                pdf.cell(0, 8, f"Total rows: {len(self.current_data)}", 0, 1)
                pdf.ln(5)
                
                # Column information
                pdf.set_font('Arial', 'B', 12)
                pdf.cell(0, 10, 'Column Information:', 0, 1)
                pdf.set_font('Arial', '', 10)
                
                for col in self.current_data.columns:
                    dtype = self.current_data[col].dtype
                    non_null = self.current_data[col].count()
                    pdf.cell(0, 6, f"  {col} ({dtype}) - {non_null} non-null values", 0, 1)
                
                pdf.ln(10)
                
                # Statistical Summary
                if self.pdf_tab.children[5].children[0].value:
                    pdf.set_font('Arial', 'B', 14)
                    pdf.cell(0, 10, 'Statistical Summary', 0, 1)
                    pdf.set_font('Arial', '', 10)
                    
                    stats = self.current_data.describe()
                    # Add basic stats to PDF
                    for col in stats.columns:
                        pdf.cell(0, 6, f"{col}:", 0, 1)
                        pdf.cell(10, 6, "", 0, 0)  # Indent
                        pdf.cell(0, 6, f"Mean: {stats[col]['mean']:.2f}, Std: {stats[col]['std']:.2f}", 0, 1)
                        pdf.cell(10, 6, "", 0, 0)  # Indent
                        pdf.cell(0, 6, f"Min: {stats[col]['min']:.2f}, Max: {stats[col]['max']:.2f}", 0, 1)
                        pdf.ln(2)
                
                # Save PDF
                pdf_path = '/content/data_analysis_report.pdf'
                pdf.output(pdf_path)
                
                print("‚úÖ PDF Report Generated Successfully!")
                print(f"üìÅ File saved as: {pdf_path}")
                
                # Provide download link
                from google.colab import files
                files.download(pdf_path)
                
                print("üì• PDF download started! Check your downloads folder.")
                
        except Exception as e:
            self.show_output(f"‚ùå Error generating PDF: {str(e)}", 'error')
    
    def clear_report_data(self, b):
        """Clear saved report data"""
        self.analysis_results = []
        self.pdf_tab.children[8].value = "No analysis results saved yet..."
        with self.main_output:
            print("‚úÖ Report data cleared!")
    
    def show_output(self, message, message_type='info'):
        """Show output message"""
        with self.main_output:
            clear_output()
            color_class = message_type  # success, error, warning, info
            print(f"<span class='{color_class}'>{message}</span>")

# Launch the interface
print("üöÄ Launching Colab Results Interface with PDF Export...")
interface = ColabPDFResultsInterface()
